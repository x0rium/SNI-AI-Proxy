# SNI AI Proxy: Smart TLS Routing via SOCKS5

A simple yet flexible proxy server that routes TLS connections based on the Server Name Indication (SNI) in the ClientHello. Allows directing traffic through a specified SOCKS5 proxy or directly to the target server. Particularly useful for AI services and development/testing scenarios.

[English](#english) | [–†—É—Å—Å–∫–∏–π](#—Ä—É—Å—Å–∫–∏–π) | [ÁÆÄ‰Ωì‰∏≠Êñá](#ÁÆÄ‰Ωì‰∏≠Êñá)
---

## English

### üöÄ Why Use It? (Use Cases)

This SNI proxy can be useful in various scenarios:

*   **üéØ AI Endpoint Routing:** Route requests to different AI model endpoints or versions (`model-a.ai.internal`, `model-b.ai.internal`) through different SOCKS5 proxies or directly, based solely on the domain name.
*   **üåç Geo-restriction Bypass:** Access AI services or APIs that are geographically restricted by routing traffic through a SOCKS5 proxy located in an allowed region.
*   **üß™ Development & Testing Isolation:** Isolate traffic during AI application development and testing by directing it through a dedicated SOCKS5 proxy. This simplifies monitoring, debugging, or simulating specific network conditions.
*   **üö¶ Version Access Control:** Manage access to different deployment stages (e.g., staging, production) of your AI services by routing connections based on the SNI hostname.

---

### ‚ö†Ô∏è Important: Usage Limitations

> This SNI proxy is primarily designed **for development, testing, or specific low-traffic use cases** where simplicity and routing flexibility are prioritized.
>
> **It is NOT engineered for and NOT recommended for high-traffic production environments.**
>
> Its simple architecture lacks features crucial for production, such as load balancing, high availability, advanced security measures, and comprehensive performance optimizations. Use in production settings at your own risk.

---

### üõ†Ô∏è Getting Started

#### Requirements

*   **Node.js**: JavaScript runtime environment.
*   **pnpm**: Package manager (you can use npm or yarn, but commands here use pnpm).
*   **Docker** (Optional): For running in a container.

#### Installation

1.  Clone the repository (if you haven't already).
2.  Install dependencies:
    ```bash
    pnpm install
    ```

#### Configuration (`config.yaml`)

The main configuration file is `config.yaml`. Key parameters:

*   `proxy_port`: The port on which the proxy will listen for incoming TLS connections (e.g., `443`).
*   `socks_proxy`: Settings for your upstream SOCKS5 proxy (used if `action: proxy`).
    *   `host`: SOCKS5 server address.
    *   `port`: SOCKS5 server port.
    *   `username` (optional): Authentication username.
    *   `password` (optional): Authentication password.
*   `routing`: SNI-based routing rules.
    *   `default`: Default action for domains not listed in `rules` (`proxy` - via SOCKS5, `direct` - connect directly).
    *   `rules`: List of rules:
        *   `domain`: Exact domain (`secure.example.com`) or wildcard pattern (`*.internal.corp`).
        *   `action`: Action for this domain/pattern (`proxy` or `direct`).
*   `logging`: Logging settings.
    *   `level`: Log detail level (`info`, `debug`, etc.).
    *   `log_dir`: Directory for log files (default `logs`).
    *   `max_size`: Maximum size of a single log file (e.g., `5m` for 5MB).
    *   `max_files`: Maximum number of log files to keep (rotation).

**Example `config.yaml`:**

```yaml
proxy_port: 443 # Listen on the standard HTTPS port

socks_proxy:
  host: 127.0.0.1
  port: 1080
  # username: user # Uncomment if authentication is needed
  # password: password

routing:
  default: direct # By default, all requests go directly
  rules:
    # Domains that should go through the SOCKS5 proxy
    - domain: "*.internal.corp"
      action: proxy
    - domain: "restricted-ai-service.com"
      action: proxy
    # Domains that should go directly (even if default=proxy)
    - domain: "public-api.com"
      action: direct

logging:
  level: info # Logging level: info, debug, warn, error
  log_dir: logs # Log file directory
  max_size: 5m # Max log file size: 5 megabytes
  max_files: 5 # Keep the last 5 log files
```

#### ‚ùó Critically Important: DNS Setup

For the proxy to intercept traffic intended for the domains in `routing.rules`, **client applications must resolve these domain names to the IP address of the machine running the SNI AI Proxy**, not the original server's IP.

Without this, the client will connect directly, bypassing the proxy.

**How to achieve this:**

1.  **Locally (for testing): `hosts` file**
    *   Find the `hosts` file on your system:
        *   Linux/macOS: `/etc/hosts`
        *   Windows: `C:\Windows\System32\drivers\etc\hosts` (requires administrator privileges to edit)
    *   Add lines in the format `<proxy-IP-address> <domain.from.rules>` for each domain to be proxied:
        ```
        # Example if the proxy is running on 192.168.1.100
        192.168.1.100 secure.example.com
        192.168.1.100 api.example.org
        192.168.1.100 model-a.ai.internal
        ```
    *   Replace `192.168.1.100` with the actual IP address of your proxy machine.

2.  **Centrally: Configure a DNS Server**
    *   If multiple clients need to use the proxy, configure your local or corporate DNS server to resolve the target domain names to the proxy's IP address for those clients.

**Choose the method that best suits your environment.**

#### Running

##### Locally

```bash
node index.js
```
The server will start listening on the `proxy_port` defined in `config.yaml`. Logs will be written to the `log_dir`.

##### Via Docker

1.  **Build the Docker image:**
    ```bash
    docker build -t sni-ai-proxy:latest .
    ```

2.  **Run the container:**
    ```bash
    # Example: run in background, map host port 443 to container port 443
    docker run -d \
      -p 443:443 \
      -v $(pwd)/config.yaml:/app/config.yaml \ # Mount config from host (recommended)
      -v $(pwd)/logs:/app/logs \              # Mount logs directory from host (optional)
      --name sni-proxy-instance \
      sni-ai-proxy:latest
    ```
    *   Ensure port `443` (or your `proxy_port`) is free on the host.
    *   `-v $(pwd)/config.yaml:/app/config.yaml`: Allows changing the config without rebuilding the image. Assumes `config.yaml` is in the current host directory.
    *   `-v $(pwd)/logs:/app/logs`: Persists logs on the host machine.

---

### üìÑ Logging

The application uses the `winston` library for logging. All settings (level, file path, rotation) are configured in the `logging` section of `config.yaml`. Check the log files in the specified directory for debugging and monitoring.

---

## –†—É—Å—Å–∫–∏–π

### üöÄ –ó–∞—á–µ–º —ç—Ç–æ –Ω—É–∂–Ω–æ? (–ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è)

–≠—Ç–æ—Ç SNI-–ø—Ä–æ–∫—Å–∏ –º–æ–∂–µ—Ç –ø—Ä–∏–≥–æ–¥–∏—Ç—å—Å—è –≤ —Å–∞–º—ã—Ö —Ä–∞–∑–Ω—ã—Ö —Å–∏—Ç—É–∞—Ü–∏—è—Ö:

*   **üéØ –ú–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏—è –∫ —ç–Ω–¥–ø–æ–∏–Ω—Ç–∞–º AI:** –ù–∞–ø—Ä–∞–≤–ª—è–π—Ç–µ –∑–∞–ø—Ä–æ—Å—ã –∫ —Ä–∞–∑–Ω—ã–º –º–æ–¥–µ–ª—è–º –∏–ª–∏ –≤–µ—Ä—Å–∏—è–º AI-—Å–µ—Ä–≤–∏—Å–æ–≤ (`model-a.ai.internal`, `model-b.ai.internal`) —á–µ—Ä–µ–∑ —Ä–∞–∑–Ω—ã–µ SOCKS5-–ø—Ä–æ–∫—Å–∏ –∏–ª–∏ –Ω–∞–ø—Ä—è–º—É—é, –ø—Ä–æ—Å—Ç–æ –Ω–∞ –æ—Å–Ω–æ–≤–µ –¥–æ–º–µ–Ω–Ω–æ–≥–æ –∏–º–µ–Ω–∏.
*   **üåç –û–±—Ö–æ–¥ –≥–µ–æ–±–ª–æ–∫–∏—Ä–æ–≤–æ–∫:** –ü–æ–ª—É—á–∞–π—Ç–µ –¥–æ—Å—Ç—É–ø –∫ AI-—Å–µ—Ä–≤–∏—Å–∞–º –∏–ª–∏ API, –¥–æ—Å—Ç—É–ø –∫ –∫–æ—Ç–æ—Ä—ã–º –æ–≥—Ä–∞–Ω–∏—á–µ–Ω –ø–æ –≥–µ–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–æ–º—É –ø—Ä–∏–∑–Ω–∞–∫—É, –ø—Ä–æ–ø—É—Å–∫–∞—è —Ç—Ä–∞—Ñ–∏–∫ —á–µ—Ä–µ–∑ SOCKS5-–ø—Ä–æ–∫—Å–∏ –≤ –Ω—É–∂–Ω–æ–π —Å—Ç—Ä–∞–Ω–µ.
*   **üß™ –ò–∑–æ–ª—è—Ü–∏—è –ø—Ä–∏ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ –∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–∏:** –û—Ç–ª–∞–∂–∏–≤–∞–π—Ç–µ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ —Å –≤–Ω–µ—à–Ω–∏–º–∏ —Å–µ—Ä–≤–∏—Å–∞–º–∏, –Ω–∞–ø—Ä–∞–≤–ª—è—è —Ç—Ä–∞—Ñ–∏–∫ –≤–∞—à–µ–≥–æ AI-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è —á–µ—Ä–µ–∑ –≤—ã–¥–µ–ª–µ–Ω–Ω—ã–π SOCKS5-–ø—Ä–æ–∫—Å–∏. –≠—Ç–æ —É–ø—Ä–æ—â–∞–µ—Ç –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥, –æ—Ç–ª–∞–¥–∫—É –∏ —Å–∏–º—É–ª—è—Ü–∏—é —Å–µ—Ç–µ–≤—ã—Ö —É—Å–ª–æ–≤–∏–π.
*   **üö¶ –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –¥–æ—Å—Ç—É–ø–æ–º –∫ –≤–µ—Ä—Å–∏—è–º:** –ö–æ–Ω—Ç—Ä–æ–ª–∏—Ä—É–π—Ç–µ –¥–æ—Å—Ç—É–ø –∫ —Ä–∞–∑–Ω—ã–º –æ–∫—Ä—É–∂–µ–Ω–∏—è–º (staging, production) –≤–∞—à–∏—Ö AI-—Å–µ—Ä–≤–∏—Å–æ–≤, –º–∞—Ä—à—Ä—É—Ç–∏–∑–∏—Ä—É—è —Ç—Ä–∞—Ñ–∏–∫ –Ω–∞ –æ—Å–Ω–æ–≤–µ SNI-–∏–º–µ–Ω–∏ —Ö–æ—Å—Ç–∞.

---

### ‚ö†Ô∏è –í–∞–∂–Ω–æ: –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

> –≠—Ç–æ—Ç SNI-–ø—Ä–æ–∫—Å–∏ —Å–æ–∑–¥–∞–Ω –≤ –ø–µ—Ä–≤—É—é –æ—á–µ—Ä–µ–¥—å **–¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏, —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –∏ —Å–ø–µ—Ü–∏—Ñ–∏—á–µ—Å–∫–∏—Ö –∑–∞–¥–∞—á —Å –Ω–µ–≤—ã—Å–æ–∫–æ–π –Ω–∞–≥—Ä—É–∑–∫–æ–π**, –≥–¥–µ –≤–∞–∂–Ω–∞ –ø—Ä–æ—Å—Ç–æ—Ç–∞ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –∏ –≥–∏–±–∫–æ—Å—Ç—å –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏–∏.
>
> **–û–Ω –ù–ï –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω –∏ –ù–ï —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –¥–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –≤ –≤—ã—Å–æ–∫–æ–Ω–∞–≥—Ä—É–∂–µ–Ω–Ω—ã—Ö production-—Å—Ä–µ–¥–∞—Ö.**
>
> –í –µ–≥–æ –ø—Ä–æ—Å—Ç–æ–π –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–µ –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –≤–∞–∂–Ω—ã–µ –¥–ª—è production —Ñ—É–Ω–∫—Ü–∏–∏: –±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫–∞ –Ω–∞–≥—Ä—É–∑–∫–∏, –≤—ã—Å–æ–∫–∞—è –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å (high availability), –ø—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–µ –º–µ—Ö–∞–Ω–∏–∑–º—ã –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –∏ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –≤ production –Ω–∞ —Å–≤–æ–π —Å—Ç—Ä–∞—Ö –∏ —Ä–∏—Å–∫.

---

### üõ†Ô∏è –ù–∞—á–∞–ª–æ —Ä–∞–±–æ—Ç—ã

#### –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è

*   **Node.js**: –°—Ä–µ–¥–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è JavaScript.
*   **pnpm**: –ú–µ–Ω–µ–¥–∂–µ—Ä –ø–∞–∫–µ—Ç–æ–≤ (–º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å npm –∏–ª–∏ yarn, –Ω–æ –∫–æ–º–∞–Ω–¥—ã –≤ README –ø—Ä–∏–≤–µ–¥–µ–Ω—ã –¥–ª—è pnpm).
*   **Docker** (–û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ): –î–ª—è –∑–∞–ø—É—Å–∫–∞ –≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–µ.

#### –£—Å—Ç–∞–Ω–æ–≤–∫–∞

1.  –ö–ª–æ–Ω–∏—Ä—É–π—Ç–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π (–µ—Å–ª–∏ –µ—â–µ –Ω–µ —Å–¥–µ–ª–∞–ª–∏).
2.  –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:
    ```bash
    pnpm install
    ```

#### –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è (`config.yaml`)

–û—Å–Ω–æ–≤–Ω–æ–π —Ñ–∞–π–ª –Ω–∞—Å—Ç—Ä–æ–µ–∫ ‚Äì `config.yaml`. –í–æ—Ç –∫–ª—é—á–µ–≤—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã:

*   `proxy_port`: –ü–æ—Ä—Ç, –Ω–∞ –∫–æ—Ç–æ—Ä–æ–º –ø—Ä–æ–∫—Å–∏ –±—É–¥–µ—Ç —Å–ª—É—à–∞—Ç—å –≤—Ö–æ–¥—è—â–∏–µ TLS-—Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è (–Ω–∞–ø—Ä–∏–º–µ—Ä, `443`).
*   `socks_proxy`: –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –≤–∞—à–µ–≥–æ SOCKS5-–ø—Ä–æ–∫—Å–∏, —á–µ—Ä–µ–∑ –∫–æ—Ç–æ—Ä—ã–π –±—É–¥–µ—Ç –∏–¥—Ç–∏ —Ç—Ä–∞—Ñ–∏–∫ (–µ—Å–ª–∏ `action: proxy`).
    *   `host`: –ê–¥—Ä–µ—Å SOCKS5-—Å–µ—Ä–≤–µ—Ä–∞.
    *   `port`: –ü–æ—Ä—Ç SOCKS5-—Å–µ—Ä–≤–µ—Ä–∞.
    *   `username` (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ): –õ–æ–≥–∏–Ω –¥–ª—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏.
    *   `password` (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ): –ü–∞—Ä–æ–ª—å –¥–ª—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏.
*   `routing`: –ü—Ä–∞–≤–∏–ª–∞ –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏–∏ –Ω–∞ –æ—Å–Ω–æ–≤–µ SNI.
    *   `default`: –î–µ–π—Å—Ç–≤–∏–µ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –¥–ª—è –¥–æ–º–µ–Ω–æ–≤, –Ω–µ –ø–æ–ø–∞–≤—à–∏—Ö –≤ `rules` (`proxy` - —á–µ—Ä–µ–∑ SOCKS5, `direct` - –Ω–∞–ø—Ä—è–º—É—é).
    *   `rules`: –°–ø–∏—Å–æ–∫ –ø—Ä–∞–≤–∏–ª:
        *   `domain`: –¢–æ—á–Ω—ã–π –¥–æ–º–µ–Ω (`secure.example.com`) –∏–ª–∏ —à–∞–±–ª–æ–Ω (`*.internal.corp`).
        *   `action`: –î–µ–π—Å—Ç–≤–∏–µ –¥–ª—è —ç—Ç–æ–≥–æ –¥–æ–º–µ–Ω–∞/—à–∞–±–ª–æ–Ω–∞ (`proxy` –∏–ª–∏ `direct`).
*   `logging`: –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è.
    *   `level`: –£—Ä–æ–≤–µ–Ω—å –¥–µ—Ç–∞–ª–∏–∑–∞—Ü–∏–∏ –ª–æ–≥–æ–≤ (`info`, `debug` –∏ —Ç.–¥.).
    *   `log_dir`: –ü–∞–ø–∫–∞ –¥–ª—è —Ñ–∞–π–ª–æ–≤ –ª–æ–≥–æ–≤ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é `logs`).
    *   `max_size`: –ú–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π —Ä–∞–∑–º–µ—Ä –æ–¥–Ω–æ–≥–æ —Ñ–∞–π–ª–∞ –ª–æ–≥–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä, `5m` –¥–ª—è 5MB).
    *   `max_files`: –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ö—Ä–∞–Ω–∏–º—ã—Ö —Ñ–∞–π–ª–æ–≤ –ª–æ–≥–æ–≤ (—Ä–æ—Ç–∞—Ü–∏—è).

**–ü—Ä–∏–º–µ—Ä `config.yaml`:**

```yaml
proxy_port: 443 # –°–ª—É—à–∞–µ–º –Ω–∞ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–º HTTPS –ø–æ—Ä—Ç—É

socks_proxy:
  host: 127.0.0.1
  port: 1080
  # username: user # –†–∞—Å–∫–æ–º–º–µ–Ω—Ç–∏—Ä—É–π—Ç–µ, –µ—Å–ª–∏ –Ω—É–∂–Ω–∞ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è
  # password: password

routing:
  default: direct # –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é –≤—Å–µ –∑–∞–ø—Ä–æ—Å—ã –∏–¥—É—Ç –Ω–∞–ø—Ä—è–º—É—é
  rules:
    # –î–æ–º–µ–Ω—ã, –∫–æ—Ç–æ—Ä—ã–µ –¥–æ–ª–∂–Ω—ã –∏–¥—Ç–∏ —á–µ—Ä–µ–∑ SOCKS5 –ø—Ä–æ–∫—Å–∏
    - domain: "*.internal.corp"
      action: proxy
    - domain: "restricted-ai-service.com"
      action: proxy
    # –î–æ–º–µ–Ω—ã, –∫–æ—Ç–æ—Ä—ã–µ –¥–æ–ª–∂–Ω—ã –∏–¥—Ç–∏ –Ω–∞–ø—Ä—è–º—É—é (–¥–∞–∂–µ –µ—Å–ª–∏ default=proxy)
    - domain: "public-api.com"
      action: direct

logging:
  level: info # –£—Ä–æ–≤–µ–Ω—å –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è: info, debug, warn, error
  log_dir: logs # –ü–∞–ø–∫–∞ –¥–ª—è –ª–æ–≥–æ–≤
  max_size: 5m # –ú–∞–∫—Å. —Ä–∞–∑–º–µ—Ä —Ñ–∞–π–ª–∞ –ª–æ–≥–∞: 5 –º–µ–≥–∞–±–∞–π—Ç
  max_files: 5 # –•—Ä–∞–Ω–∏—Ç—å –ø–æ—Å–ª–µ–¥–Ω–∏–µ 5 —Ñ–∞–π–ª–æ–≤ –ª–æ–≥–æ–≤
```

#### ‚ùó –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –≤–∞–∂–Ω–æ: –ù–∞—Å—Ç—Ä–æ–π–∫–∞ DNS

–ß—Ç–æ–±—ã –ø—Ä–æ–∫—Å–∏ –º–æ–≥ –ø–µ—Ä–µ—Ö–≤–∞—Ç—ã–≤–∞—Ç—å —Ç—Ä–∞—Ñ–∏–∫ –¥–ª—è –¥–æ–º–µ–Ω–æ–≤ –∏–∑ `routing.rules`, **–∫–ª–∏–µ–Ω—Ç—Å–∫–∏–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –¥–æ–ª–∂–Ω—ã –æ–±—Ä–∞—â–∞—Ç—å—Å—è –Ω–µ –∫ —Ä–µ–∞–ª—å–Ω–æ–º—É IP –∞–¥—Ä–µ—Å—É —ç—Ç–∏—Ö –¥–æ–º–µ–Ω–æ–≤, –∞ –∫ IP-–∞–¥—Ä–µ—Å—É –º–∞—à–∏–Ω—ã, –≥–¥–µ –∑–∞–ø—É—â–µ–Ω SNI AI Proxy**.

–ë–µ–∑ —ç—Ç–æ–≥–æ –∫–ª–∏–µ–Ω—Ç –±—É–¥–µ—Ç –ø–æ–¥–∫–ª—é—á–∞—Ç—å—Å—è –Ω–∞–ø—Ä—è–º—É—é, –∏ –ø—Ä–æ–∫—Å–∏ –Ω–µ —Å–º–æ–∂–µ—Ç –æ–±—Ä–∞–±–æ—Ç–∞—Ç—å —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ.

**–ö–∞–∫ —ç—Ç–æ —Å–¥–µ–ª–∞—Ç—å:**

1.  **–õ–æ–∫–∞–ª—å–Ω–æ (–¥–ª—è —Ç–µ—Å—Ç–æ–≤): –§–∞–π–ª `hosts`**
    *   –ù–∞–π–¥–∏—Ç–µ —Ñ–∞–π–ª `hosts` –Ω–∞ –≤–∞—à–µ–º –∫–æ–º–ø—å—é—Ç–µ—Ä–µ:
        *   Linux/macOS: `/etc/hosts`
        *   Windows: `C:\Windows\System32\drivers\etc\hosts` (—Ç—Ä–µ–±—É—é—Ç—Å—è –ø—Ä–∞–≤–∞ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞ –¥–ª—è —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è)
    *   –î–æ–±–∞–≤—å—Ç–µ —Å—Ç—Ä–æ–∫–∏ –≤–∏–¥–∞ `<IP-–∞–¥—Ä–µ—Å-–ø—Ä–æ–∫—Å–∏> <–¥–æ–º–µ–Ω.–∏–∑.–ø—Ä–∞–≤–∏–ª>` –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –¥–æ–º–µ–Ω–∞, –∫–æ—Ç–æ—Ä—ã–π –¥–æ–ª–∂–µ–Ω –∏–¥—Ç–∏ —á–µ—Ä–µ–∑ –ø—Ä–æ–∫—Å–∏:
        ```
        # –ü—Ä–∏–º–µ—Ä, –µ—Å–ª–∏ –ø—Ä–æ–∫—Å–∏ –∑–∞–ø—É—â–µ–Ω –Ω–∞ 192.168.1.100
        192.168.1.100 secure.example.com
        192.168.1.100 api.example.org
        192.168.1.100 model-a.ai.internal
        ```
    *   –ó–∞–º–µ–Ω–∏—Ç–µ `192.168.1.100` –Ω–∞ —Ä–µ–∞–ª—å–Ω—ã–π IP –≤–∞—à–µ–π –º–∞—à–∏–Ω—ã —Å –ø—Ä–æ–∫—Å–∏.

2.  **–¶–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–æ: –ù–∞—Å—Ç—Ä–æ–π–∫–∞ DNS-—Å–µ—Ä–≤–µ—Ä–∞**
    *   –ï—Å–ª–∏ –≤–∞–º –Ω—É–∂–Ω–æ, —á—Ç–æ–±—ã –Ω–µ—Å–∫–æ–ª—å–∫–æ –∫–ª–∏–µ–Ω—Ç–æ–≤ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª–∏ –ø—Ä–æ–∫—Å–∏, –Ω–∞—Å—Ç—Ä–æ–π—Ç–µ –≤–∞—à –ª–æ–∫–∞–ª—å–Ω—ã–π –∏–ª–∏ –∫–æ—Ä–ø–æ—Ä–∞—Ç–∏–≤–Ω—ã–π DNS-—Å–µ—Ä–≤–µ—Ä —Ç–∞–∫, —á—Ç–æ–±—ã –æ–Ω –≤–æ–∑–≤—Ä–∞—â–∞–ª IP-–∞–¥—Ä–µ—Å –ø—Ä–æ–∫—Å–∏ –¥–ª—è –Ω—É–∂–Ω—ã—Ö –¥–æ–º–µ–Ω–Ω—ã—Ö –∏–º–µ–Ω.

**–í—ã–±–µ—Ä–∏—Ç–µ —Å–ø–æ—Å–æ–±, –∫–æ—Ç–æ—Ä—ã–π –ø–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è –≤–∞—à–µ–π –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—ã.**

#### –ó–∞–ø—É—Å–∫

##### –õ–æ–∫–∞–ª—å–Ω–æ

```bash
node index.js
```
–°–µ—Ä–≤–µ—Ä –∑–∞–ø—É—Å—Ç–∏—Ç—Å—è –∏ –Ω–∞—á–Ω–µ—Ç —Å–ª—É—à–∞—Ç—å –ø–æ—Ä—Ç, —É–∫–∞–∑–∞–Ω–Ω—ã–π –≤ `proxy_port` (`config.yaml`). –õ–æ–≥–∏ –±—É–¥—É—Ç –ø–∏—Å–∞—Ç—å—Å—è –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é, —É–∫–∞–∑–∞–Ω–Ω—É—é –≤ `log_dir`.

##### –ß–µ—Ä–µ–∑ Docker

1.  **–°–æ–±–µ—Ä–∏—Ç–µ Docker-–æ–±—Ä–∞–∑:**
    ```bash
    docker build -t sni-ai-proxy:latest .
    ```

2.  **–ó–∞–ø—É—Å—Ç–∏—Ç–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä:**
    ```bash
    # –ü—Ä–∏–º–µ—Ä: –∑–∞–ø—É—Å–∫–∞–µ–º –≤ —Ñ–æ–Ω–µ, –ø—Ä–æ–±—Ä–∞—Å—ã–≤–∞–µ–º –ø–æ—Ä—Ç 443 —Ö–æ—Å—Ç–∞ –Ω–∞ 443 –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞
    docker run -d \
      -p 443:443 \
      -v $(pwd)/config.yaml:/app/config.yaml \ # –ú–æ–Ω—Ç–∏—Ä—É–µ–º –∫–æ–Ω—Ñ–∏–≥ —Å —Ö–æ—Å—Ç–∞ (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)
      -v $(pwd)/logs:/app/logs \              # –ú–æ–Ω—Ç–∏—Ä—É–µ–º –ø–∞–ø–∫—É –ª–æ–≥–æ–≤ —Å —Ö–æ—Å—Ç–∞ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
      --name sni-proxy-instance \
      sni-ai-proxy:latest
    ```
    *   –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –ø–æ—Ä—Ç `443` (–∏–ª–∏ —Ç–æ—Ç, —á—Ç–æ –≤ `proxy_port`) –Ω–∞ —Ö–æ—Å—Ç–µ —Å–≤–æ–±–æ–¥–µ–Ω.
    *   `-v $(pwd)/config.yaml:/app/config.yaml`: –ü–æ–∑–≤–æ–ª—è–µ—Ç –∏–∑–º–µ–Ω—è—Ç—å –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é –±–µ–∑ –ø–µ—Ä–µ—Å–±–æ—Ä–∫–∏ –æ–±—Ä–∞–∑–∞. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ `config.yaml` –ª–µ–∂–∏—Ç –≤ —Ç–µ–∫—É—â–µ–π –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ –Ω–∞ —Ö–æ—Å—Ç–µ.
    *   `-v $(pwd)/logs:/app/logs`: –ü–æ–∑–≤–æ–ª—è–µ—Ç —Å–æ—Ö—Ä–∞–Ω—è—Ç—å –ª–æ–≥–∏ –Ω–∞ —Ö–æ—Å—Ç-–º–∞—à–∏–Ω–µ.

---

#### üìÑ –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –±–∏–±–ª–∏–æ—Ç–µ–∫—É `winston` –¥–ª—è –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è. –í—Å–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ (—É—Ä–æ–≤–µ–Ω—å, –ø—É—Ç—å –∫ —Ñ–∞–π–ª–∞–º, —Ä–æ—Ç–∞—Ü–∏—è) –∑–∞–¥–∞—é—Ç—Å—è –≤ —Å–µ–∫—Ü–∏–∏ `logging` —Ñ–∞–π–ª–∞ `config.yaml`. –ü—Ä–æ—Å–º–∞—Ç—Ä–∏–≤–∞–π—Ç–µ —Ñ–∞–π–ª—ã –ª–æ–≥–æ–≤ –≤ —É–∫–∞–∑–∞–Ω–Ω–æ–π –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏ –∏ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ —Ä–∞–±–æ—Ç—ã –ø—Ä–æ–∫—Å–∏.

---

## ÁÆÄ‰Ωì‰∏≠Êñá

### üöÄ ‰∏∫‰Ωï‰ΩøÁî®Ôºü (‰ΩøÁî®Âú∫ÊôØ)

Ê≠§ SNI ‰ª£ÁêÜÂèØÂú®Â§öÁßçÂú∫ÊôØ‰∏≠ÂèëÊå•‰ΩúÁî®Ôºö

*   **üéØ AI Á´ØÁÇπË∑ØÁî±Ôºö** Ê†πÊçÆÂüüÂêçÂ∞ÜËØ∑Ê±ÇË∑ØÁî±Âà∞‰∏çÂêåÁöÑ AI Ê®°ÂûãÁ´ØÁÇπÊàñÁâàÊú¨ (`model-a.ai.internal`, `model-b.ai.internal`)ÔºåÂèØ‰ª•ÈÄâÊã©ÈÄöËøá‰∏çÂêåÁöÑ SOCKS5 ‰ª£ÁêÜÊàñÁõ¥Êé•ËøûÊé•„ÄÇ
*   **üåç ÁªïËøáÂú∞ÁêÜÈôêÂà∂Ôºö** ÈÄöËøá‰Ωç‰∫éÂÖÅËÆ∏Âå∫ÂüüÁöÑ SOCKS5 ‰ª£ÁêÜË∑ØÁî±ÊµÅÈáèÔºåËÆøÈóÆÂèóÂú∞ÁêÜ‰ΩçÁΩÆÈôêÂà∂ÁöÑ AI ÊúçÂä°Êàñ API„ÄÇ
*   **üß™ ÂºÄÂèë‰∏éÊµãËØïÈöîÁ¶ªÔºö** Âú® AI Â∫îÁî®ÂºÄÂèëÂíåÊµãËØïÊúüÈó¥ÔºåÈÄöËøáÂ∞ÜÊµÅÈáèÂÆöÂêëÂà∞‰∏ìÁî®ÁöÑ SOCKS5 ‰ª£ÁêÜÊù•ÈöîÁ¶ªÊµÅÈáè„ÄÇËøôÁÆÄÂåñ‰∫ÜÁõëÊéß„ÄÅË∞ÉËØïÊàñÊ®°ÊãüÁâπÂÆöÁΩëÁªúÊù°‰ª∂„ÄÇ
*   **üö¶ ÁâàÊú¨ËÆøÈóÆÊéßÂà∂Ôºö** ÈÄöËøáÂü∫‰∫é SNI ‰∏ªÊú∫ÂêçË∑ØÁî±ËøûÊé•ÔºåÁÆ°ÁêÜÂØπ AI ÊúçÂä°‰∏çÂêåÈÉ®ÁΩ≤Èò∂ÊÆµÔºà‰æãÂ¶ÇÔºåÈ¢ÑÂèëÂ∏É staging„ÄÅÁîü‰∫ß productionÔºâÁöÑËÆøÈóÆ„ÄÇ

---

### ‚ö†Ô∏è ÈáçË¶ÅÊèêÁ§∫Ôºö‰ΩøÁî®ÈôêÂà∂

> Ê≠§ SNI ‰ª£ÁêÜ‰∏ªË¶ÅËÆæËÆ°Áî®‰∫é**ÂºÄÂèë„ÄÅÊµãËØïÊàñ‰ºòÂÖàËÄÉËôëÁÆÄÂçïÊÄßÂíåË∑ØÁî±ÁÅµÊ¥ªÊÄßÁöÑÁâπÂÆö‰ΩéÊµÅÈáèÁî®‰æã**„ÄÇ
>
> **ÂÆÉÂπ∂Èùû‰∏∫È´òÊµÅÈáèÁîü‰∫ßÁéØÂ¢ÉËÆæËÆ°Ôºå‰πü‰∏çÊé®ËçêÁî®‰∫éÊ≠§Á±ªÁéØÂ¢É„ÄÇ**
>
> ÂÖ∂ÁÆÄÂçïÁöÑÊû∂ÊûÑÁº∫‰πèÁîü‰∫ßÁéØÂ¢ÉÊâÄÂøÖÈúÄÁöÑÂÖ≥ÈîÆÂäüËÉΩÔºå‰æãÂ¶ÇË¥üËΩΩÂùáË°°„ÄÅÈ´òÂèØÁî®ÊÄß„ÄÅÈ´òÁ∫ßÂÆâÂÖ®Êé™ÊñΩÂíåÂÖ®Èù¢ÁöÑÊÄßËÉΩ‰ºòÂåñ„ÄÇÂú®Áîü‰∫ßÁéØÂ¢É‰∏≠‰ΩøÁî®ÈúÄËá™Ë°åÊâøÊãÖÈ£éÈô©„ÄÇ

---

### üõ†Ô∏è ÂºÄÂßã‰ΩøÁî®

#### ÁéØÂ¢ÉË¶ÅÊ±Ç

*   **Node.js**: JavaScript ËøêË°åÊó∂ÁéØÂ¢É„ÄÇ
*   **pnpm**: ÂåÖÁÆ°ÁêÜÂô® (ÊÇ®‰πüÂèØ‰ª•‰ΩøÁî® npm Êàñ yarn, ‰ΩÜÊú¨ÊñáÊ°£‰∏≠ÁöÑÂëΩ‰ª§‰ΩøÁî® pnpm)„ÄÇ
*   **Docker** (ÂèØÈÄâ): Áî®‰∫éÂú®ÂÆπÂô®‰∏≠ËøêË°å„ÄÇ

#### ÂÆâË£Ö

1.  ÂÖãÈöÜ‰ª£Á†ÅÂ∫ì (Â¶ÇÊûúÂ∞öÊú™ÂÖãÈöÜ)„ÄÇ
2.  ÂÆâË£Ö‰æùËµñÔºö
    ```bash
    pnpm install
    ```

#### ÈÖçÁΩÆ (`config.yaml`)

‰∏ªÈÖçÁΩÆÊñá‰ª∂ÊòØ `config.yaml`„ÄÇÂÖ≥ÈîÆÂèÇÊï∞Ôºö

*   `proxy_port`: ‰ª£ÁêÜÁõëÂê¨‰º†ÂÖ• TLS ËøûÊé•ÁöÑÁ´ØÂè£ (‰æãÂ¶Ç `443`)„ÄÇ
*   `socks_proxy`: ‰∏äÊ∏∏ SOCKS5 ‰ª£ÁêÜÁöÑËÆæÁΩÆ (ÂΩì `action: proxy` Êó∂‰ΩøÁî®)„ÄÇ
    *   `host`: SOCKS5 ÊúçÂä°Âô®Âú∞ÂùÄ„ÄÇ
    *   `port`: SOCKS5 ÊúçÂä°Âô®Á´ØÂè£„ÄÇ
    *   `username` (ÂèØÈÄâ): ËÆ§ËØÅÁî®Êà∑Âêç„ÄÇ
    *   `password` (ÂèØÈÄâ): ËÆ§ËØÅÂØÜÁ†Å„ÄÇ
*   `routing`: Âü∫‰∫é SNI ÁöÑË∑ØÁî±ËßÑÂàô„ÄÇ
    *   `default`: ÂØπ‰∫éÊú™Âú® `rules` ‰∏≠ÂàóÂá∫ÁöÑÂüüÂêçÁöÑÈªòËÆ§Êìç‰Ωú (`proxy` - ÈÄöËøá SOCKS5, `direct` - Áõ¥Êé•ËøûÊé•)„ÄÇ
    *   `rules`: ËßÑÂàôÂàóË°®Ôºö
        *   `domain`: Á≤æÁ°ÆÂüüÂêç (`secure.example.com`) ÊàñÈÄöÈÖçÁ¨¶Ê®°Âºè (`*.internal.corp`)„ÄÇ
        *   `action`: ÈíàÂØπÊ≠§ÂüüÂêç/Ê®°ÂºèÁöÑÊìç‰Ωú (`proxy` Êàñ `direct`)„ÄÇ
*   `logging`: Êó•ÂøóËÆ∞ÂΩïËÆæÁΩÆ„ÄÇ
    *   `level`: Êó•ÂøóËØ¶ÁªÜÁ∫ßÂà´ (`info`, `debug` Á≠â)„ÄÇ
    *   `log_dir`: Êó•ÂøóÊñá‰ª∂ÁõÆÂΩï (ÈªòËÆ§‰∏∫ `logs`)„ÄÇ
    *   `max_size`: Âçï‰∏™Êó•ÂøóÊñá‰ª∂ÁöÑÊúÄÂ§ßÂ§ßÂ∞è (‰æãÂ¶Ç `5m` ‰ª£Ë°® 5MB)„ÄÇ
    *   `max_files`: ‰øùÁïôÁöÑÊúÄÂ§ßÊó•ÂøóÊñá‰ª∂Êï∞Èáè (ËΩÆÊç¢)„ÄÇ

**`config.yaml` Á§∫‰æã:**

```yaml
proxy_port: 443 # ÁõëÂê¨Ê†áÂáÜÁöÑ HTTPS Á´ØÂè£

socks_proxy:
  host: 127.0.0.1
  port: 1080
  # username: user # Â¶ÇÊûúÈúÄË¶ÅËÆ§ËØÅÔºåËØ∑ÂèñÊ∂àÊ≥®Èáä
  # password: password

routing:
  default: direct # ÈªòËÆ§ÊâÄÊúâËØ∑Ê±ÇÁõ¥Êé•ËøûÊé•
  rules:
    # ÈúÄË¶ÅÈÄöËøá SOCKS5 ‰ª£ÁêÜÁöÑÂüüÂêç
    - domain: "*.internal.corp"
      action: proxy
    - domain: "restricted-ai-service.com"
      action: proxy
    # ÈúÄË¶ÅÁõ¥Êé•ËøûÊé•ÁöÑÂüüÂêç (Âç≥‰Ωø default=proxy)
    - domain: "public-api.com"
      action: direct

logging:
  level: info # Êó•ÂøóÁ∫ßÂà´: info, debug, warn, error
  log_dir: logs # Êó•ÂøóÊñá‰ª∂ÁõÆÂΩï
  max_size: 5m # ÊúÄÂ§ßÊó•ÂøóÊñá‰ª∂Â§ßÂ∞è: 5 MB
  max_files: 5 # ‰øùÁïôÊúÄËøë 5 ‰∏™Êó•ÂøóÊñá‰ª∂
```

#### ‚ùó Ëá≥ÂÖ≥ÈáçË¶ÅÔºöDNS ËÆæÁΩÆ

‰∏∫‰∫ÜËÆ©‰ª£ÁêÜËÉΩÂ§üÊã¶Êà™ÂèëÂæÄ `routing.rules` ‰∏≠ÊåáÂÆöÂüüÂêçÁöÑÊµÅÈáèÔºå**ÂÆ¢Êà∑Á´ØÂ∫îÁî®Á®ãÂ∫èÂøÖÈ°ªÂ∞ÜËøô‰∫õÂüüÂêçËß£Êûê (resolve) Âà∞ËøêË°å SNI AI Proxy ÁöÑÊú∫Âô®ÁöÑ IP Âú∞ÂùÄ**ÔºåËÄå‰∏çÊòØÂéüÂßãÊúçÂä°Âô®ÁöÑ IP Âú∞ÂùÄ„ÄÇ

Âê¶ÂàôÔºåÂÆ¢Êà∑Á´ØÂ∞ÜÁõ¥Êé•ËøûÊé•Ôºå‰ªéËÄåÁªïËøá‰ª£ÁêÜ„ÄÇ

**Â¶Ç‰ΩïÂÆûÁé∞Ôºö**

1.  **Êú¨Âú∞ (Áî®‰∫éÊµãËØï)Ôºö`hosts` Êñá‰ª∂**
    *   ÊâæÂà∞ÊÇ®Á≥ªÁªü‰∏äÁöÑ `hosts` Êñá‰ª∂Ôºö
        *   Linux/macOS: `/etc/hosts`
        *   Windows: `C:\Windows\System32\drivers\etc\hosts` (ÁºñËæëÈúÄË¶ÅÁÆ°ÁêÜÂëòÊùÉÈôê)
    *   ‰∏∫ÊØè‰∏™ÈúÄË¶Å‰ª£ÁêÜÁöÑÂüüÂêçÊ∑ªÂä†Ê†ºÂºè‰∏∫ `<‰ª£ÁêÜIPÂú∞ÂùÄ> <ËßÑÂàô‰∏≠ÁöÑÂüüÂêç>` ÁöÑË°åÔºö
        ```
        # Á§∫‰æãÔºöÂ¶ÇÊûú‰ª£ÁêÜËøêË°åÂú® 192.168.1.100
        192.168.1.100 secure.example.com
        192.168.1.100 api.example.org
        192.168.1.100 model-a.ai.internal
        ```
    *   Â∞Ü `192.168.1.100` ÊõøÊç¢‰∏∫ÊÇ®‰ª£ÁêÜÊú∫Âô®ÁöÑÂÆûÈôÖ IP Âú∞ÂùÄ„ÄÇ

2.  **ÈõÜ‰∏≠ÂºèÔºöÈÖçÁΩÆ DNS ÊúçÂä°Âô®**
    *   Â¶ÇÊûúÂ§ö‰∏™ÂÆ¢Êà∑Á´ØÈúÄË¶Å‰ΩøÁî®‰ª£ÁêÜÔºåËØ∑ÈÖçÁΩÆÊÇ®ÁöÑÊú¨Âú∞Êàñ‰ºÅ‰∏ö DNS ÊúçÂä°Âô®Ôºå‰∏∫Ëøô‰∫õÂÆ¢Êà∑Á´ØÂ∞ÜÁõÆÊ†áÂüüÂêçËß£ÊûêÂà∞‰ª£ÁêÜÁöÑ IP Âú∞ÂùÄ„ÄÇ

**ËØ∑ÈÄâÊã©ÊúÄÈÄÇÂêàÊÇ®ÁéØÂ¢ÉÁöÑÊñπÊ≥ï„ÄÇ**

#### ËøêË°å

##### Êú¨Âú∞ËøêË°å

```bash
node index.js
```
ÊúçÂä°Âô®Â∞ÜÂêØÂä®Âπ∂Âú® `config.yaml` ‰∏≠ÂÆö‰πâÁöÑ `proxy_port` ‰∏äÁõëÂê¨„ÄÇÊó•ÂøóÂ∞ÜÂÜôÂÖ• `log_dir` ÁõÆÂΩï„ÄÇ

##### ÈÄöËøá Docker ËøêË°å

1.  **ÊûÑÂª∫ Docker ÈïúÂÉèÔºö**
    ```bash
    docker build -t sni-ai-proxy:latest .
    ```

2.  **ËøêË°åÂÆπÂô®Ôºö**
    ```bash
    # Á§∫‰æãÔºöÂêéÂè∞ËøêË°åÔºåÂ∞ÜÂÆø‰∏ªÊú∫ÁöÑ 443 Á´ØÂè£Êò†Â∞ÑÂà∞ÂÆπÂô®ÁöÑ 443 Á´ØÂè£
    docker run -d \
      -p 443:443 \
      -v $(pwd)/config.yaml:/app/config.yaml \ # ‰ªéÂÆø‰∏ªÊú∫ÊåÇËΩΩÈÖçÁΩÆÊñá‰ª∂ (Êé®Ëçê)
      -v $(pwd)/logs:/app/logs \              # ‰ªéÂÆø‰∏ªÊú∫ÊåÇËΩΩÊó•ÂøóÁõÆÂΩï (ÂèØÈÄâ)
      --name sni-proxy-instance \
      sni-ai-proxy:latest
    ```
    *   Á°Æ‰øùÂÆø‰∏ªÊú∫‰∏äÁöÑÁ´ØÂè£ `443` (ÊàñÊÇ®ÁöÑ `proxy_port`) Êú™Ë¢´Âç†Áî®„ÄÇ
    *   `-v $(pwd)/config.yaml:/app/config.yaml`: ÂÖÅËÆ∏Âú®‰∏çÈáçÊñ∞ÊûÑÂª∫ÈïúÂÉèÁöÑÊÉÖÂÜµ‰∏ãÊõ¥ÊîπÈÖçÁΩÆ„ÄÇÂÅáËÆæ `config.yaml` ‰Ωç‰∫éÂÆø‰∏ªÊú∫ÁöÑÂΩìÂâçÁõÆÂΩï„ÄÇ
    *   `-v $(pwd)/logs:/app/logs`: Â∞ÜÊó•ÂøóÊåÅ‰πÖÂåñÂà∞ÂÆø‰∏ªÊú∫„ÄÇ

---

### üìÑ Êó•ÂøóËÆ∞ÂΩï

ËØ•Â∫îÁî®Á®ãÂ∫è‰ΩøÁî® `winston` Â∫ìËøõË°åÊó•ÂøóËÆ∞ÂΩï„ÄÇÊâÄÊúâËÆæÁΩÆÔºàÁ∫ßÂà´„ÄÅÊñá‰ª∂Ë∑ØÂæÑ„ÄÅËΩÆÊç¢ÔºâÈÉΩÂú® `config.yaml` ÁöÑ `logging` ÈÉ®ÂàÜËøõË°åÈÖçÁΩÆ„ÄÇÊ£ÄÊü•ÊåáÂÆöÁõÆÂΩï‰∏≠ÁöÑÊó•ÂøóÊñá‰ª∂‰ª•ËøõË°åË∞ÉËØïÂíåÁõëÊéß„ÄÇ